<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>NEXUS AUTO PRO 2026</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="stylesheet" href="styles.css" />

  <!-- Fuente -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">

  <!-- jsPDF UMD -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" crossorigin="anonymous"></script>
</head>
<body>
  <!-- Pantalla de PIN / Login -->
  <div id="pin-screen">
    <div class="pin-box glass">
      <h1>NEXUS AUTO PRO 2026</h1>
      <p class="subtitle">Gestión integral de talleres automotrices</p>

      <label for="pin-input">PIN de acceso (4–6 dígitos)</label>
      <input
        id="pin-input"
        type="password"
        inputmode="numeric"
        pattern="\\d{4,6}"
        maxlength="6"
        minlength="4"
        placeholder="••••"
      />
      <button id="pin-login-btn" class="btn primary wide">Entrar con PIN</button>

      <div class="divider">
        <span>o</span>
      </div>

      <button id="google-login-btn" class="btn google wide">
        Iniciar sesión con Google
      </button>

      <p id="pin-error" class="error-msg"></p>
    </div>
  </div>

  <!-- Aplicación principal -->
  <div id="app" class="hidden">
    <header class="topbar">
      <div class="brand">
        <img id="header-logo-img" class="brand-logo-img hidden" alt="Logo taller" />
        <div class="brand-text">
          <span class="brand-logo" id="header-logo-text">NEXUS</span>
          <span class="brand-sub" id="header-workshop-name">AUTO PRO 2026</span>
        </div>
      </div>
      <nav class="menu">
        <button class="menu-btn active" data-section="dashboard-section">Inicio</button>
        <button class="menu-btn" data-section="entries-section">Entradas</button>
        <button class="menu-btn" data-section="deliveries-section">Entregas</button>
        <button class="menu-btn" data-section="history-section">Historial cliente</button>
        <button class="menu-btn" data-section="quotes-section">Cotizaciones</button>
        <button class="menu-btn" data-section="invoices-section">Facturas</button>
        <button class="menu-btn" data-section="price-list-section">Lista de precios</button>
        <button class="menu-btn" data-section="clients-section">Clientes</button>
        <button class="menu-btn" data-section="suppliers-section">Suplidores</button>
        <button class="menu-btn" data-section="payments-section">Pagos/Reportes</button>
        <button class="menu-btn" data-section="settings-section">Configuración</button>
      </nav>
      <div class="user-box">
        <span id="user-email"></span>
        <button id="logout-btn" class="btn small danger">Salir</button>
      </div>
    </header>

    <main>
      <!-- Dashboard -->
      <section id="dashboard-section" class="section active">
        <h2>Dashboard</h2>
        <div class="cards">
          <div class="card">
            <h3>Entradas activas</h3>
            <p id="stat-active-entries">0</p>
          </div>
          <div class="card">
            <h3>Facturas pendientes</h3>
            <p id="stat-pending-invoices">0</p>
          </div>
          <div class="card">
            <h3>Pagos de hoy</h3>
            <p id="stat-today-payments">$0.00</p>
          </div>
        </div>
      </section>

      <!-- Entradas de vehículos -->
      <section id="entries-section" class="section">
        <h2>Entradas de vehículos</h2>
        <form id="entry-form" class="form-grid">
          <h3>Nuevo registro de entrada</h3>

          <div class="form-row">
            <label>Nombre del cliente</label>
            <input id="entry-client-name" required />
          </div>
          <div class="form-row">
            <label>Teléfono</label>
            <input id="entry-client-phone" />
          </div>
          <div class="form-row">
            <label>Dirección</label>
            <input id="entry-client-address" />
          </div>
          <div class="form-row">
            <label>Tablilla</label>
            <input id="entry-plate" />
          </div>
          <div class="form-row">
            <label>Color</label>
            <input id="entry-color" />
          </div>
          <div class="form-row">
            <label>Marca y modelo</label>
            <input id="entry-make-model" />
          </div>
          <div class="form-row">
            <label>VIN Number</label>
            <input id="entry-vin" />
          </div>
          <div class="form-row">
            <label>Tipo de trabajo</label>
            <select id="entry-job-type">
              <option value="Mecánica">Mecánica</option>
              <option value="Hojalatería y pintura">Hojalatería y pintura</option>
              <option value="Detailing">Detailing</option>
              <option value="Otro">Otro</option>
            </select>
          </div>

          <div class="form-row full">
            <label>Trabajo sugerido</label>
            <textarea id="entry-suggested-work"></textarea>
          </div>
          <div class="form-row full">
            <label>Diagnóstico</label>
            <textarea id="entry-diagnosis"></textarea>
          </div>
          <div class="form-row full">
            <label>Reparación mecánica</label>
            <textarea id="entry-mech-repair"></textarea>
          </div>
          <div class="form-row full">
            <label>Reparación de carrocería</label>
            <textarea id="entry-body-repair"></textarea>
          </div>
          <div class="form-row full">
            <label>Trabajo de pintura</label>
            <textarea id="entry-paint-work"></textarea>
          </div>

          <div class="form-row">
            <label>Fecha de entrada</label>
            <input id="entry-date" type="date" />
          </div>
          <div class="form-row">
            <label>Estado del vehículo</label>
            <select id="entry-status">
              <option value="En reparación">En reparación</option>
              <option value="Listo">Listo</option>
              <option value="Entregado">Entregado</option>
            </select>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn primary">Guardar entrada</button>
          </div>
        </form>

        <h3>Entradas registradas</h3>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Fecha</th>
                <th>Cliente</th>
                <th>Teléfono</th>
                <th>Vehículo</th>
                <th>Tablilla</th>
                <th>Tipo trabajo</th>
                <th>Estado</th>
              </tr>
            </thead>
            <tbody id="entries-table-body"></tbody>
          </table>
        </div>
      </section>

      <!-- Entregas -->
      <section id="deliveries-section" class="section">
        <h2>Registros de entrega</h2>
        <form id="delivery-form" class="form-grid">
          <h3>Nueva entrega</h3>
          <div class="form-row">
            <label>Fecha de entrega</label>
            <input id="delivery-date" type="date" required />
          </div>
          <div class="form-row">
            <label>Cliente</label>
            <input id="delivery-client" required />
          </div>
          <div class="form-row">
            <label>Vehículo</label>
            <input id="delivery-vehicle" required />
          </div>
          <div class="form-row">
            <label>Trabajo realizado</label>
            <input id="delivery-work" />
          </div>
          <div class="form-row">
            <label>Monto facturado</label>
            <input id="delivery-amount" type="number" step="0.01" />
          </div>
          <div class="form-row full">
            <label>Fotos (URLs antes/después)</label>
            <textarea id="delivery-photos" placeholder="Una URL por línea"></textarea>
          </div>
          <div class="form-actions">
            <button type="submit" class="btn primary">Guardar entrega</button>
          </div>
        </form>

        <h3>Entregas registradas</h3>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Fecha</th>
                <th>Cliente</th>
                <th>Vehículo</th>
                <th>Trabajo</th>
                <th>Monto</th>
              </tr>
            </thead>
            <tbody id="deliveries-table-body"></tbody>
          </table>
        </div>
      </section>

      <!-- Historial por cliente -->
      <section id="history-section" class="section">
        <h2>Historial por cliente</h2>
        <div class="form-inline">
          <input id="history-search" placeholder="Buscar por cliente, tablilla o VIN" />
          <button id="history-search-btn" class="btn primary">Buscar</button>
        </div>
        <div id="history-results" class="history-results">
          <!-- Resultados -->
        </div>
      </section>

      <!-- Cotizaciones -->
      <section id="quotes-section" class="section">
        <h2>Cotizaciones</h2>

        <form id="quote-form" class="form-grid">
          <h3>Nueva cotización</h3>
          <div class="form-row">
            <label>Cliente</label>
            <select id="quote-client-select"></select>
          </div>
          <div class="form-row">
            <label>Teléfono</label>
            <input id="quote-client-phone" />
          </div>
          <div class="form-row">
            <label>Vehículo (marca/modelo)</label>
            <input id="quote-vehicle" />
          </div>
          <div class="form-row">
            <label>Tablilla</label>
            <input id="quote-plate" />
          </div>
          <div class="form-row">
            <label>VIN</label>
            <input id="quote-vin" />
          </div>
          <div class="form-row">
            <label>Fecha</label>
            <input id="quote-date" type="date" />
          </div>

          <div class="form-row full">
            <h4>Servicios y piezas</h4>
            <div class="form-inline">
              <select id="quote-price-item-select"></select>
              <input id="quote-item-qty" type="number" min="1" value="1" />
              <button id="quote-add-item-btn" type="button" class="btn secondary">Agregar ítem</button>
            </div>
            <div class="table-wrapper small">
              <table>
                <thead>
                  <tr>
                    <th>Descripción</th>
                    <th>Cant.</th>
                    <th>Precio unitario</th>
                    <th>Total</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody id="quote-items-body"></tbody>
              </table>
            </div>
          </div>

          <div class="form-row">
            <label>Subtotal</label>
            <input id="quote-subtotal" type="number" step="0.01" readonly />
          </div>
          <div class="form-row">
            <label>Impuestos</label>
            <input id="quote-tax" type="number" step="0.01" value="0" />
          </div>
          <div class="form-row">
            <label>Total</label>
            <input id="quote-total" type="number" step="0.01" readonly />
          </div>

          <div class="form-actions">
            <button type="submit" class="btn primary">Guardar cotización</button>
            <button id="quote-print-btn" type="button" class="btn secondary">
              Imprimir (PDF)
            </button>
          </div>
        </form>

        <h3>Historial de cotizaciones</h3>
        <div class="form-inline">
          <input id="quote-search" placeholder="Cliente / número / fecha" />
        </div>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>ID</th>
                <th>Fecha</th>
                <th>Cliente</th>
                <th>Vehículo</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody id="quotes-table-body"></tbody>
          </table>
        </div>
      </section>

      <!-- Facturas -->
      <section id="invoices-section" class="section">
        <h2>Facturas</h2>

        <form id="invoice-form" class="form-grid">
          <h3>Nueva factura</h3>

          <div class="form-row full">
            <label>Cargar desde cotización (ID)</label>
            <div class="form-inline">
              <input id="invoice-from-quote-id" placeholder="ID de cotización" />
              <button id="invoice-load-from-quote-btn" type="button" class="btn secondary">
                Cargar cotización
              </button>
            </div>
          </div>

          <div class="form-row">
            <label>Número de factura</label>
            <input id="invoice-number" />
          </div>
          <div class="form-row">
            <label>Fecha</label>
            <input id="invoice-date" type="date" />
          </div>

          <div class="form-row">
            <label>Cliente</label>
            <select id="invoice-client-select"></select>
          </div>
          <div class="form-row">
            <label>Vehículo</label>
            <input id="invoice-vehicle" />
          </div>
          <div class="form-row">
            <label>Tablilla</label>
            <input id="invoice-plate" />
          </div>
          <div class="form-row">
            <label>VIN</label>
            <input id="invoice-vin" />
          </div>

          <div class="form-row full">
            <h4>Servicios y piezas</h4>
            <div class="form-inline">
              <select id="invoice-price-item-select"></select>
              <input id="invoice-item-qty" type="number" min="1" value="1" />
              <button id="invoice-add-item-btn" type="button" class="btn secondary">Agregar ítem</button>
            </div>
            <div class="table-wrapper small">
              <table>
                <thead>
                  <tr>
                    <th>Descripción</th>
                    <th>Cant.</th>
                    <th>Precio unitario</th>
                    <th>Total</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody id="invoice-items-body"></tbody>
              </table>
            </div>
          </div>

          <div class="form-row">
            <label>Subtotal</label>
            <input id="invoice-subtotal" type="number" step="0.01" readonly />
          </div>
          <div class="form-row">
            <label>Impuestos</label>
            <input id="invoice-tax" type="number" step="0.01" value="0" />
          </div>
          <div class="form-row">
            <label>Total</label>
            <input id="invoice-total" type="number" step="0.01" readonly />
          </div>
          <div class="form-row">
            <label>Estado</label>
            <select id="invoice-status">
              <option value="Pendiente">Pendiente</option>
              <option value="Pagada">Pagada</option>
            </select>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn primary">Guardar factura</button>
            <button id="invoice-print-btn" type="button" class="btn secondary">
              Imprimir (PDF)
            </button>
          </div>
        </form>

        <h3>Historial de facturas</h3>
        <div class="form-inline">
          <input id="invoice-search" placeholder="Cliente / número / fecha" />
        </div>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>ID</th>
                <th>Fecha</th>
                <th>Cliente</th>
                <th>Total</th>
                <th>Estado</th>
              </tr>
            </thead>
            <tbody id="invoices-table-body"></tbody>
          </table>
        </div>
      </section>

      <!-- Lista de precios -->
      <section id="price-list-section" class="section">
        <h2>Lista de precios</h2>
        <form id="price-item-form" class="form-grid">
          <h3>Nuevo ítem</h3>
          <div class="form-row">
            <label>Nombre</label>
            <input id="price-item-name" required />
          </div>
          <div class="form-row">
            <label>Categoría</label>
            <select id="price-item-category">
              <option value="Mecánica">Mecánica</option>
              <option value="Hojalatería">Hojalatería</option>
              <option value="Pintura">Pintura</option>
              <option value="Detailing">Detailing</option>
              <option value="Otro">Otro</option>
            </select>
          </div>
          <div class="form-row full">
            <label>Descripción</label>
            <textarea id="price-item-description"></textarea>
          </div>
          <div class="form-row">
            <label>Precio</label>
            <input id="price-item-price" type="number" step="0.01" required />
          </div>
          <div class="form-actions">
            <button type="submit" class="btn primary">Guardar ítem</button>
          </div>
        </form>

        <h3>Ítems registrados</h3>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Nombre</th>
                <th>Categoría</th>
                <th>Precio</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="price-list-table-body"></tbody>
          </table>
        </div>
      </section>

      <!-- Clientes -->
      <section id="clients-section" class="section">
        <h2>Clientes</h2>
        <form id="client-form" class="form-grid">
          <h3>Nuevo cliente</h3>
          <div class="form-row">
            <label>Nombre</label>
            <input id="client-name" required />
          </div>
          <div class="form-row">
            <label>Teléfono</label>
            <input id="client-phone" />
          </div>
          <div class="form-row full">
            <label>Dirección</label>
            <input id="client-address" />
          </div>
          <div class="form-row">
            <label>Email</label>
            <input id="client-email" type="email" />
          </div>
          <div class="form-actions">
            <button type="submit" class="btn primary">Guardar cliente</button>
          </div>
        </form>

        <h3>Clientes registrados</h3>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Nombre</th>
                <th>Teléfono</th>
                <th>Email</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="clients-table-body"></tbody>
          </table>
        </div>
      </section>

      <!-- Suplidores -->
      <section id="suppliers-section" class="section">
        <h2>Suplidores</h2>
        <form id="supplier-form" class="form-grid">
          <h3>Nuevo suplidor</h3>
          <div class="form-row">
            <label>Nombre</label>
            <input id="supplier-name" required />
          </div>
          <div class="form-row">
            <label>Teléfono</label>
            <input id="supplier-phone" />
          </div>
          <div class="form-row full">
            <label>Dirección</label>
            <input id="supplier-address" />
          </div>
          <div class="form-row">
            <label>Email</label>
            <input id="supplier-email" type="email" />
          </div>
          <div class="form-row full">
            <label>Notas</label>
            <textarea id="supplier-notes"></textarea>
          </div>
          <div class="form-actions">
            <button type="submit" class="btn primary">Guardar suplidor</button>
          </div>
        </form>

        <h3>Suplidores registrados</h3>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Nombre</th>
                <th>Teléfono</th>
                <th>Email</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="suppliers-table-body"></tbody>
          </table>
        </div>
      </section>

      <!-- Pagos / Reportes -->
      <section id="payments-section" class="section">
        <h2>Pagos y reportes</h2>

        <form id="payment-form" class="form-grid">
          <h3>Registrar pago</h3>
          <div class="form-row">
            <label>Cliente</label>
            <select id="payment-client-select"></select>
          </div>
          <div class="form-row">
            <label>Factura</label>
            <select id="payment-invoice-select"></select>
          </div>
          <div class="form-row">
            <label>Monto</label>
            <input id="payment-amount" type="number" step="0.01" required />
          </div>
          <div class="form-row">
            <label>Fecha</label>
            <input id="payment-date" type="date" />
          </div>
          <div class="form-row">
            <label>Método</label>
            <select id="payment-method">
              <option value="Efectivo">Efectivo</option>
              <option value="Tarjeta">Tarjeta</option>
              <option value="Transferencia">Transferencia</option>
              <option value="Otro">Otro</option>
            </select>
          </div>
          <div class="form-actions">
            <button type="submit" class="btn primary">Guardar pago</button>
          </div>
        </form>

        <h3>Resumen de facturas</h3>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Factura</th>
                <th>Cliente</th>
                <th>Total</th>
                <th>Pagado</th>
                <th>Balance</th>
                <th>Estado</th>
              </tr>
            </thead>
            <tbody id="payments-invoice-summary-body"></tbody>
          </table>
        </div>

        <div class="form-actions right">
          <button id="payments-report-pdf-btn" class="btn secondary">
            Reporte PDF
          </button>
        </div>
      </section>

      <!-- Configuración -->
      <section id="settings-section" class="section">
        <h2>Configuración</h2>

        <form id="settings-workshop-form" class="form-grid">
          <h3>Datos del taller</h3>
          <div class="form-row">
            <label>Nombre del taller</label>
            <input id="settings-workshop-name" />
          </div>
          <div class="form-row full">
            <label>Dirección</label>
            <input id="settings-workshop-address" />
          </div>
          <div class="form-row">
            <label>Teléfonos</label>
            <input id="settings-workshop-phones" />
          </div>
          <div class="form-row">
            <label>Email</label>
            <input id="settings-workshop-email" type="email" />
          </div>
          <div class="form-row full">
            <label>Horario</label>
            <input id="settings-workshop-schedule" />
          </div>
          <div class="form-row full">
            <label>Logo del taller</label>
            <input id="settings-workshop-logo-file" type="file" accept="image/*" />
          </div>
          <div class="form-actions">
            <button type="submit" class="btn primary">Guardar configuración</button>
          </div>
        </form>

        <form id="settings-pin-form" class="form-grid">
          <h3>PIN de acceso</h3>
          <div class="form-row">
            <label>PIN actual</label>
            <input id="settings-current-pin" type="password" />
          </div>
          <div class="form-row">
            <label>Nuevo PIN (4–6 dígitos)</label>
            <input id="settings-new-pin" type="password" />
          </div>
          <div class="form-actions">
            <button type="submit" class="btn secondary">Cambiar PIN</button>
          </div>
        </form>

        <div class="config-block">
          <h3>Información de Firebase (documentación)</h3>
          <div class="config-grid">
            <div>
              <label>apiKey</label>
              <input value="AIzaSyAouzcePuYPfGBajbqFFotTNNr_gx_XCYQ" readonly />
            </div>
            <div>
              <label>authDomain</label>
              <input value="nexus-auto-pro-2026.firebaseapp.com" readonly />
            </div>
            <div>
              <label>projectId</label>
              <input value="nexus-auto-pro-2026" readonly />
            </div>
            <div>
              <label>storageBucket</label>
              <input value="nexus-auto-pro-2026.firebasestorage.app" readonly />
            </div>
            <div>
              <label>messagingSenderId</label>
              <input value="308014641424" readonly />
            </div>
            <div>
              <label>appId</label>
              <input value="1:308014641424:web:5157d1267e280c48eeb595" readonly />
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- App principal -->
  <script type="module" src="app.js"></script>
</body>
</html>
